---
layout: post
title:  "Microsoft Word 0day - CVE-2021-40444"
date:   2021-09-13 16:00:00 +0700
categories: research
author: Quang Vo
toc: true
description: Research analysis and develop a working exploit poc script 
tags: CVE-2021-40444, Word, 0-day
---

## Intro
This is one of the newest zero day from Microsoft, and a dangerous one. With only 1-click to open the document, the attacker is able to gain remote code execution on victim's machine. These 0-day exploits are found in phishing campaign where attacker craft a document impersonating contracts and legal agreements, where the documents themselves were hosted on file-sharing sites. The exploit document use `OLEObject` - external relationship object to embedded Javacsript in the HTML file.

The Javascript code does:
- Download CAB file contain DLL file bearing the `.INF` file extension.
- Decompression the CAB file,
- Execute functions in DLL file.


<img width="967" alt="image" src="https://user-images.githubusercontent.com/37280106/133014906-1593581c-9783-40aa-9506-b36c13b839e8.png">

<img width="866" alt="image" src="https://user-images.githubusercontent.com/37280106/133014985-e0e951f1-5afd-451d-849f-b33dcb7e5569.png">


<img width="941" alt="image" src="https://user-images.githubusercontent.com/37280106/133015033-a6ca621c-756e-4bb3-a3b9-48a17812bd06.png">


<img width="1100" alt="image" src="https://user-images.githubusercontent.com/37280106/133015261-79fc9c83-13fd-4856-8790-8cb68aca84bc.png">
