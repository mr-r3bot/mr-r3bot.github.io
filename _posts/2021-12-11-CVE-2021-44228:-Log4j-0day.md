---
layout: post
title:  "Apache Log4j RCE 0day: CVE-2021-44228"
date:   2021-12-11 16:00:00 +0700
categories: research
author: Quang Vo
description: Research analysis and develop a working exploit poc script 
---

Reference:
- https://www.lunasec.io/docs/blog/log4j-zero-day/
- https://www.veracode.com/blog/research/exploiting-jndi-injections-java


## Introduction Apache Log4j and Description of the vulnerability
Apache Log4j is one of the most popular logging library, widely used in Java web applications and Apache products ( such as Apeche Struts, Apache Solr, ... ).
Because of the nature of the library is logging, the data being logged originates from user inputs. If the user input contains some special characters and logged by `Log4j`, the Java method `lookup` will be called to execute a user-defined remote class in the LDAP server.
This will eventually becomes RCE ( depends on environment configrations ) 

## Affected version 

Apache Log4j 2.x <= 2.15.0-rc1

## Affected Software

There have been reports said that Steam, Apple and Twitter vulnerable to this attack, and other softwares like:
- Apache Struts
- Apache Solr
- Elasticsearch
- Ghidra

...

## Exploitation


## Mitigation
- Update to log4j version `2.15.0-rc2` 
- Block all untrusted outbound traffic
- Add "log4j.format.msg.nolookups=true" global configuration

